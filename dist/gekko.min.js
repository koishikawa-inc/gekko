(function(n,o){typeof exports=="object"&&typeof module<"u"?module.exports=o():typeof define=="function"&&define.amd?define(o):(n=typeof globalThis<"u"?globalThis:n||self,n.Gekko=o())})(this,function(){"use strict";var I=Object.defineProperty;var b=(n,o,s)=>o in n?I(n,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[o]=s;var u=(n,o,s)=>(b(n,typeof o!="symbol"?o+"":o,s),s);const n=Math.pow,o=Math.sqrt,s=Math.sin,g=Math.cos,a=Math.PI,d=1.70158,f=d*1.525,v=d+1,y=2*a/3,k=2*a/4.5;function m(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}const M={inQuad:function(t){return t*t},outQuad:function(t){return 1-(1-t)*(1-t)},inOutQuad:function(t){return t<.5?2*t*t:1-n(-2*t+2,2)/2},inCubic:function(t){return t*t*t},outCubic:function(t){return 1-n(1-t,3)},inOutCubic:function(t){return t<.5?4*t*t*t:1-n(-2*t+2,3)/2},inQuart:function(t){return t*t*t*t},outQuart:function(t){return 1-n(1-t,4)},inOutQuart:function(t){return t<.5?8*t*t*t*t:1-n(-2*t+2,4)/2},inQuint:function(t){return t*t*t*t*t},outQuint:function(t){return 1-n(1-t,5)},inOutQuint:function(t){return t<.5?16*t*t*t*t*t:1-n(-2*t+2,5)/2},inSine:function(t){return 1-g(t*a/2)},outSine:function(t){return s(t*a/2)},inOutSine:function(t){return-(g(a*t)-1)/2},inExpo:function(t){return t===0?0:n(2,10*t-10)},outExpo:function(t){return t===1?1:1-n(2,-10*t)},inOutExpo:function(t){return t===0?0:t===1?1:t<.5?n(2,20*t-10)/2:(2-n(2,-20*t+10))/2},inCirc:function(t){return 1-o(1-n(t,2))},outCirc:function(t){return o(1-n(t-1,2))},inOutCirc:function(t){return t<.5?(1-o(1-n(2*t,2)))/2:(o(1-n(-2*t+2,2))+1)/2},inElastic:function(t){return t===0?0:t===1?1:-n(2,10*t-10)*s((t*10-10.75)*y)},outElastic:function(t){return t===0?0:t===1?1:n(2,-10*t)*s((t*10-.75)*y)+1},inOutElastic:function(t){return t===0?0:t===1?1:t<.5?-(n(2,20*t-10)*s((20*t-11.125)*k))/2:n(2,-20*t+10)*s((20*t-11.125)*k)/2+1},inBack:function(t){return v*t*t*t-d*t*t},outBack:function(t){return 1+v*n(t-1,3)+d*n(t-1,2)},inOutBack:function(t){return t<.5?n(2*t,2)*((f+1)*2*t-f)/2:(n(2*t-2,2)*((f+1)*(t*2-2)+f)+2)/2},inBounce:function(t){return 1-m(1-t)},outBounce:m,inOutBounce:function(t){return t<.5?(1-m(1-2*t))/2:(1+m(2*t-1))/2},linear:function(t){return t}};class Q{constructor(e){u(this,"params");u(this,"isStop",!1);u(this,"isScrolling",!1);u(this,"delayTimeoutId",null);u(this,"currentAnchor",null);u(this,"optionsDefault",{speed:1e3,isSpeedAsDuration:!1,delay:0,easing:"outQuad",offset:0});u(this,"clickHandler",e=>{this.onClick(e)});u(this,"error",(...e)=>{console.error("Gekko",...e)});this.params={...this.optionsDefault,...e},document.querySelectorAll("a").forEach(r=>{r.target||r.addEventListener("click",this.clickHandler)}),window.location.hash&&(window.scrollTo(0,0),this.scroll(window.location.hash));const i="onwheel"in document?"wheel":"onmousewheel"in document?"mousewheel":"DOMMouseScroll";document.addEventListener(i,()=>{this.onScroll()}),document.addEventListener("touchstart",()=>{this.onScroll()})}scroll(e,i=!0){var l;const r=document.getElementById(e.replace("#",""));if(r){this.isStop=!1;const h=window.scrollY||document.documentElement.scrollTop,p=r.getBoundingClientRect().top+h;document.dispatchEvent(new CustomEvent("beforeScroll",{detail:{anchor:e}}));let c;typeof this.params.offset=="number"?c=this.params.offset:typeof this.params.offset=="string"?c=((l=document.querySelector(this.params.offset))==null?void 0:l.getBoundingClientRect().height)||0:typeof this.params.offset=="function"?c=this.params.offset():c=0;const S=Math.max(0,p-c),w=S-h;if(w===0)return;this.currentAnchor=e,history.pushState({},"",e);const T=()=>{if(i){this.isScrolling=!0;const B=this.params.isSpeedAsDuration?this.params.speed:Math.abs(w/this.params.speed)*1e3;let E=null;const A=C=>{E===null&&(E=C);const O=(C-E)/B;O<1&&!this.isStop?(window.scrollTo(0,h+w*M[this.params.easing](O)),window.requestAnimationFrame(A)):this.isStop?(this.isScrolling=!1,this.currentAnchor=null,document.dispatchEvent(new CustomEvent("stopScroll",{detail:{anchor:e}}))):(window.scrollTo(0,S),this.isScrolling=!1,this.currentAnchor=null,document.dispatchEvent(new CustomEvent("afterScroll",{detail:{anchor:e}})))};window.requestAnimationFrame(A)}else window.scrollTo(0,S),this.currentAnchor=null};this.params.delay>0?this.delayTimeoutId=setTimeout(()=>{this.delayTimeoutId=null,this.isStop||T()},this.params.delay):T()}else this.error(`#${e} is not found.`)}stop(){if(this.isStop=!0,this.delayTimeoutId!==null&&(clearTimeout(this.delayTimeoutId),this.delayTimeoutId=null,this.currentAnchor!==null)){const e=this.currentAnchor;this.currentAnchor=null,document.dispatchEvent(new CustomEvent("stopScroll",{detail:{anchor:e}}))}}on(e,i){const r=l=>{i(l.detail.anchor)};document.addEventListener(e,r)}options(e){this.params={...this.params,...e}}destroy(){this.stop(),document.querySelectorAll("a").forEach(i=>{i.removeEventListener("click",this.clickHandler)});const e="onwheel"in document?"wheel":"onmousewheel"in document?"mousewheel":"DOMMouseScroll";document.removeEventListener(e,this.onScroll),document.removeEventListener("touchstart",this.onScroll)}onClick(e){const i=e.currentTarget;if(!i){this.error("Unexpected error occurred. Target does not exist.");return}const r=c=>c.replace(/\/$/,""),l=`${i.protocol}//${i.host}${r(i.pathname)}`,h=r(location.origin+location.pathname),p=l===h?i.hash:"";p&&i.dataset.gekko!=="no-smooth"&&(e.preventDefault(),e.stopPropagation(),this.scroll(p))}onScroll(){this.isScrolling&&this.stop()}}return Q});
